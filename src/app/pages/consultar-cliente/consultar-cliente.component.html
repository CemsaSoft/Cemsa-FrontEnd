<app-navbar></app-navbar>

<div class="body">
  <h1 class="text-center titulo tituloFuente">Consultar Cliente</h1>
  <!-- Contenido de breadcrumb -->
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item" style="padding-left: 310px; font-size: 18px">
        <a href="/home">Home</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">
        Consultar Cliente
      </li>
    </ol>
  </nav>
  <div class="container mt-12">
    <!-- ----------------------------Inicio de Paso a Paso-------------------------------------------- -->
    <mat-vertical-stepper>
      <mat-step
        [label]="titulo1"
        [completed]="isStep1Completed"
        [ngClass]="{ collapse: isCollapsed1 }"
      >
        <ng-container contenido-paso-1>
          <div class="card-body" [ngClass]="{ collapse: isCollapsed2 }">
            <div class="row justify-content-center">
              <div class="col-10 cardFiltrado cardAnimate cardFlat">
                <div>

                  <form [formGroup]="formfiltro">

                    <div class="row">
                      <div class="col-md-2 image-container">
                        <span
                          ><img
                            style="width: 102%; height: 102"
                            src="../../../assets/icons8-user-64_1.png"
                            class="image"
                            alt="..."
                          />
                          <div class="texto">
                            <h4
                              style="
                                text-align: center;
                                color: #63ddff;
                                font-size: 18px;
                              "
                            >
                              Filtrar Cliente
                            </h4>
                            <!---->
                          </div></span
                        >
                      </div>
                      <div
                        class="col-md-2"
                        style="margin-top: 48px; padding-left: 40px"
                      >
                        <div
                          class="form-outline input-group"
                          data-toggle="tooltip"
                          data-placement="top"
                          title="Buscar por Tipo de Documento"
                        >
                          <mat-form-field
                            class="FormatoCombos;"
                            style="width: 156px"
                            appearance="outline"
                          >
                            <mat-label>Tipo Documento</mat-label>
                            <mat-select
                              style="text-align: center; border-color: #63ddff"
                              placeholder="Seleccionar"
                              formControlName="tipoF" 
                              (selectionChange)="esFiltrar()"
                            >
                              <mat-option
                                *ngFor="let tipoDocumento of tiposDocumento"
                                [value]="tipoDocumento.tdId"
                                >{{ tipoDocumento.tdDescripcion }}</mat-option
                              >
                            </mat-select>
                          </mat-form-field>
                        </div>
                      </div>

                        <div class="col-md-2 margen" style="padding-left: 0px">
                          <div
                            class="form-outline input-group"
                            data-toggle="tooltip"
                            data-placement="top"
                            title="Buscar por Numero de Documento"
                          >
                            <label class="search-field2 label">
                              <mat-label class="search-field label"
                                >N° de Documento</mat-label
                              >
                              <input
                                type="text"
                                style="width: 164px"
                                class="form-control inputBusqueda2"
                                placeholder="12.345.678"     
                                formControlName="numeroF" 
                                (input)="formatDocumentNumber($event)"
                                (keyup)="esFiltrar()"
                              />
                              
                              <i
                                class="fas fa-search FormatoIconos"
                                style="padding-left: 20px"
                              ></i>
                            </label>
                          </div>
                        </div>

                        <div
                          class="col-md-1 vertical-line"
                          style="width: 20px"
                        ></div>

                        <div class="col-md-2 margenFiltros">
                          <div
                            class="form-outline input-group"
                            data-toggle="tooltip"
                            data-placement="top"
                            title="Buscar por Nombre de Cliente"
                          >
                            <label class="search-field">
                              <mat-label
                                class="search-field label ng-tns-c97-48 ng-star-inserted"
                                >Nombre de Cliente</mat-label
                              >
                              <input
                                type="text"
                                class="form-control inputBusqueda .input-con-color-de-fondo"
                                placeholder="Ej. Felipe"
                                formControlName="clienteF" 
                                (keyup)="esFiltrar()"
                              />
                                  
                              <i class="fa-solid fa-person FormatoIconos"></i>
                            </label>
                          </div>
                        </div>

                        <div class="col-md-3 margenFiltros vertical-line">
                          <div
                            class="form-outline input-group"
                            data-toggle="tooltip"
                            data-placement="top"
                            title="Buscar por Nombre de Usuario"
                          >
                          <label class="search-field">
                              <mat-label
                                class="search-field label ng-tns-c97-48 ng-star-inserted"
                                >Nombre del Usuario</mat-label
                              >
                              <input
                                type="text"
                                class="form-control inputBusqueda .input-con-color-de-fondo"
                                placeholder="Ej. Usu123"
                                formControlName="usuarioF" 
                                (keyup)="esFiltrar()"
                              />
                                
                              <i class="fa-solid fa-user FormatoIconos"></i>
                            </label>
                          </div>
                        </div>
                      
                    </div>

                  </form>

                </div>
              </div>
            </div>

            <br />
            <br />

            <div class="row">
              <div class="col-12 cardFiltrado cardAnimate cardFlat">
                <!-- app.component.html -->
                <div class="table" *ngIf="dataSourceCliente">
                    <table mat-table [dataSource]="dataSourceCliente" matSort #matSortCliente="matSort">
      
                    <!-- Columnas -->
                    <ng-container matColumnDef="tdDescripcion">
                      <th class="encabezado text-center" mat-header-cell *matHeaderCellDef mat-sort-header="tdDescripcion">Tipo Doc.</th>
                      <td class="table-row first-column" style="vertical-align: middle; text-align: textIzquierda"  mat-cell *matCellDef="let element">{{ element.tdDescripcion }}</td>
                    </ng-container>
      
                    <ng-container matColumnDef="cliNroDoc">
                      <th class="encabezado text-center" mat-header-cell *matHeaderCellDef mat-sort-header="cliNroDoc">Num. Doc. </th>
                      <td class="table-row" style="vertical-align: middle; text-align: textIzquierda" mat-cell *matCellDef="let element">{{ element.cliNroDoc }}</td>
                    </ng-container>
      
                    <ng-container matColumnDef="cliApeNomDen">
                      <th class="encabezado text-center" mat-header-cell *matHeaderCellDef mat-sort-header="cliApeNomDen">Cliente</th>
                      <td class="table-row" style="vertical-align: middle; text-align: textIzquierda" mat-cell *matCellDef="let element">{{ element.cliApeNomDen }}</td>
                    </ng-container>
      
                    <ng-container matColumnDef="usuario">
                      <th class="encabezado text-center" mat-header-cell *matHeaderCellDef mat-sort-header="usuario">Usuario</th>
                      <td class="table-row" style="vertical-align: middle; text-align: textIzquierda" mat-cell *matCellDef="let element">{{ element.usuario }}</td>
                    </ng-container>                      
      
                    <ng-container matColumnDef="fechaBaja">
                      <th class="encabezado text-center" mat-header-cell *matHeaderCellDef mat-sort-header="fechaBaja">Estado</th>
                      <td class="table-row" style="vertical-align: middle; text-align: textIzquierda" mat-cell *matCellDef="let element">
                        <span *ngIf="element.fechaBaja === null">Activo</span>
                        <span *ngIf="element.fechaBaja !== null">Baja</span>
                      </td>
                    </ng-container>   
            
                    <!-- Columna vacia -->
                    <ng-container matColumnDef="columnaVacia">
                      <th class="encabezado text-center" mat-header-cell *matHeaderCellDef></th>
                      <td class="table-row" class="align-center" mat-cell *matCellDef="let element"></td>
                    </ng-container>
            
                    <!-- Columna de acciones -->
                    <ng-container matColumnDef="modEstado">
                      <th class="encabezado text-center" mat-header-cell *matHeaderCellDef >Modificar Estado</th>
                      <td class="table-row" class="align-center" mat-cell *matCellDef="let element">
                        <button
                          type="button"
                          *ngIf="element.fechaBaja !== null"
                          class="btn "
                          data-bs-target="#staticBackdrop"
                          (click)="modificarEstadoCliente(element, 0, 'Disponible')"
                          title="Activar Cliente"
                        >
                          <img
                            src="../../../assets/check.png"
                            class="iconosBoton"
                            alt="..."
                          />
                        </button>
                        <button
                          type="button"
                          *ngIf="element.fechaBaja === null"
                          class="btn "
                          data-bs-target="#staticBackdrop"
                          (click)="modificarEstadoCliente(element, 1, 'Baja')"
                          title="Dar de Baja Cliente"
                        >
                          <img
                            src="../../../assets/no check.png"
                            class="iconosBoton"
                            alt="..."
                          />
                        </button>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="seleccionar">
                      <th class="encabezado text-center" mat-header-cell *matHeaderCellDef >Seleccionar</th>
                      <td class="table-row" class="align-center" mat-cell *matCellDef="let element">
                        <button
                          mat-button
                          (click)="esfilaSeleccionadaCliente(element)"
                          
                          type="button"
                          class="btn"
                          data-bs-target="#staticBackdrop"
                          title="Seleccionar Cliente"
                        >
                          <img
                            src="../../../assets/seleccionar_user.png"
                            class="iconosBoton"
                            alt="..."
                          />
                        </button>
                      </td>
                    </ng-container>

                    <!-- Filas -->
                    <tr mat-header-row *matHeaderRowDef="displayedColumnsCliente"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumnsCliente;
                      let i = index" [ngClass]="{ 'fila-par': i % 2 === 0, 'fila-impar': i % 2 !== 0 }">
                    </tr>
                    
                  </table>
            
                  <!-- Paginador -->
                  <mat-paginator *ngIf="dataSourceCliente"
                    [length]="dataSourceCliente.data.length"
                    [pageSize]="pageSizeCliente"
                    [pageSizeOptions]="[5, 15, 25, 50, 100]"
                    (page)="handlePageChangeCliente($event)"
                    showFirstLastButtons
                    #paginatorCliente
                  ></mat-paginator>
            
                  <div class="align-center" *ngIf="validarFiltradoClientes() == true">
                  </div>
            
                  <div class="alert alert-primary text-center" role="alert" *ngIf="validarFiltradoClientes() == false">
                    No se encontraron clientes que coincidan con su búsqueda.
                  </div>
            
                </div>
              </div>          
            </div>

          </div>
        </ng-container>
      </mat-step>
      <mat-step [label]="titulo2" [completed]="isStep2Completed">
        <ng-container contenido-paso-2>
          <!-- Botón ver otro cliente -->
          <div class="row">
            <div
              class="example-button-row"
              style="display: flex; justify-content: flex-end"
            >
              <button
                mat-fab
                extended
                color="primary"
                class="btonNuevaConsulta"
                (click)="goToPreviousStep()"
              >
                <mat-icon>touch_app</mat-icon>
                Nueva Consulta
              </button>
            </div>
          </div>

          <br>
          <br>
          
          <!-- Contenido del segundo paso específico de la página -->
          <div class="card cardFiltrado cardAnimate cardFlat">
            <div class="card-header">
              <div class="d-flex justify-content-between align-items-center">
                <h4 class="mb-0 tituloCard">Cliente Seleccionado</h4>
                <img
                  src="../../../assets/user.png"
                  class="image"
                  style="width: 5%; height: 5%; padding-right: 5px"
                  alt="..."
                />
              </div>
            </div>
            <div class="card-body" [ngClass]="{ collapse: isCollapsed2 }">
              <form [formGroup]="formModificar">
                <div class="container">
                  <div class="row">
                    <div class="col-sm-9" style="justify-content: right">
                      <div class="row justify-content-center">
                        <div class="col-50 col-sm-50">
                          <!--------------------  Edición .col-10 col-sm-10---------------------------------->
                          <div class="row">
                            <div class="col-md-3">
                              <div class="form-outline input-group mb-3">
                                <mat-form-field
                                  appearance="fill"
                                  class="example-full-width form-outline input-group"
                                >
                                  <mat-label>Tipo de Documento</mat-label>
                                  <input
                                    type="text"
                                    class="enabled"
                                    style="padding-left: 20px"
                                    matInput
                                    id="tipoDocumento"
                                    value="tipoDocumento"
                                    formControlName="tipoDocumento"
                                    required
                                    readonly
                                  />
                                  <mat-icon class="enabled" matSuffix
                                    >edit_off</mat-icon
                                  >
                                </mat-form-field>
                              </div>
                            </div>
                            <div class="col-md-3">
                              <div class="form-outline input-group mb-3">
                                <mat-form-field
                                  appearance="fill"
                                  class="example-full-width form-outline input-group"
                                >
                                  <mat-label>Número de Documento</mat-label>
                                  <input
                                    type="text"
                                    class="enabled"
                                    style="padding-left: 20px"
                                    matInput
                                    id="nroDoc"
                                    value="nroDoc"
                                    formControlName="nroDoc"
                                    required
                                    readonly
                                  />
                                  <mat-icon class="enabled" matSuffix
                                    >edit_off</mat-icon
                                  >
                                </mat-form-field>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-3 mb-3">
                              <div class="form-outline input-group mb-3">
                                <mat-form-field
                                  appearance="fill"
                                  class="example-full-width form-outline input-group"
                                >
                                  <mat-label>Cliente</mat-label>
                                  <input
                                    type="text"
                                    style="padding-left: 20px"
                                    matInput
                                    id="cliApeNomDen"
                                    value="cliApeNomDen"
                                    formControlName="cliApeNomDen"
                                    required
                                  />
                                  <mat-icon class="edit" matSuffix
                                    >edit</mat-icon
                                  >
                                </mat-form-field>
                                <mat-error
                                  *ngIf="
                                    cliApeNomDen?.invalid &&
                                    (cliApeNomDen?.dirty ||
                                      cliApeNomDen?.touched)
                                  "
                                  class="text-danger"
                                >
                                  <mat-error
                                    class="error"
                                    *ngIf="cliApeNomDen?.errors?.['required']"
                                  >
                                    El Cliente es requerido.
                                  </mat-error>
                                  <mat-error
                                    class="error"
                                    *ngIf="cliApeNomDen?.errors?.['pattern']"
                                  >
                                    La primera letra del Nombre del Cliente debe
                                    ser Mayúscula, no se admiten caracteres especiales.
                                  </mat-error>
                                  <mat-error
                                    class="error"
                                    *ngIf="cliApeNomDen?.errors?.['minlength']"
                                  >
                                    El Nombre del Cliente debe tener al menos 3
                                    caracteres.
                                  </mat-error>
                                  <mat-error
                                    class="error"
                                    *ngIf="cliApeNomDen?.errors?.['maxlength']"
                                  >
                                    El Nombre del Cliente debe tener menos de 50 caracteres.
                                  </mat-error>
                                </mat-error>
                              </div>
                            </div>
                            <div class="col-md-3">
                              <div class="form-outline input-group mb-3">
                                <mat-form-field
                                  appearance="fill"
                                  class="example-full-width form-outline input-group"
                                >
                                  <mat-label>Usuario</mat-label>
                                  <input
                                    type="text"
                                    style="padding-left: 20px"
                                    matInput
                                    id="usuario"
                                    value="usuario"
                                    formControlName="usuario"
                                    required
                                  />
                                  <mat-icon class="edit" matSuffix
                                    >edit</mat-icon
                                  >
                                </mat-form-field>
                               
                                <mat-error
                                  *ngIf="
                                    usuario?.invalid &&
                                    (usuario?.dirty || usuario?.touched)
                                  "
                                  class="text-danger"
                                >
                                  <mat-error
                                    class="error"
                                    *ngIf="usuario?.errors?.['required']"
                                  >
                                    El Usuario es requerido.
                                  </mat-error>
                                  <mat-error
                                    class="error"
                                    *ngIf="usuario?.errors?.['pattern']"
                                  >
                                    El Nombre del Usuario no admiten caracteres especiales.
                                  </mat-error>
                                  <mat-error
                                    class="error"
                                    *ngIf="usuario?.errors?.['minlength']"
                                  >
                                    El Nombre del Usuario debe tener al menos 3
                                    caracteres.
                                  </mat-error>
                                  <mat-error
                                    class="error"
                                    *ngIf="usuario?.errors?.['maxlength']"
                                  >
                                  El Nombre del Usuario debe tener menos de 50 caracteres.
                                  </mat-error>
                                </mat-error>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-3 mb-3">
                              <div class="form-outline input-group mb-3">
                                <mat-form-field
                                  appearance="fill"
                                  class="example-full-width form-outline input-group"
                                >
                                  <mat-label>Email</mat-label>
                                  <input
                                    type="email"
                                    style="padding-left: 20px"
                                    matInput
                                    id="email"
                                    value="email"
                                    formControlName="email"
                                    required
                                  />
                                  <mat-icon class="edit" matSuffix
                                    >edit</mat-icon
                                  >
                                </mat-form-field>
                                <mat-error
                                  class="error"
                                  *ngIf="
                                    email?.invalid &&
                                    (email?.dirty || email?.touched)
                                  "
                                  class="text-danger"
                                >
                                <mat-error
                                    class="error"
                                    *ngIf="email?.errors?.['required']"
                                  >
                                  El correo electrónico es requerido.
                                  </mat-error>
                                  <mat-error
                                    class="error"
                                    *ngIf="email?.errors?.['email']"
                                  >
                                    El correo electrónico es inválido.
                                  </mat-error>
                                  <mat-error
                                    class="error"
                                    *ngIf="email?.errors?.['maxlength']"
                                  >
                                  El mail del debe tener menos de 30 caracteres.
                                  </mat-error>
                                </mat-error>
                              </div>
                            </div>
                            <div class="col-md-3">
                              <div class="form-outline input-group mb-3">
                                <mat-form-field
                                  appearance="fill"
                                  class="example-full-width form-outline input-group"
                                  style="top: 10px"
                                >
                                  <mat-label>Teléfono</mat-label>
                                  <input
                                    type="text"
                                    style="padding-left: 20px"
                                    matInput
                                    id="telefono"
                                    value="telefono"
                                    formControlName="telefono"
                                    required
                                  />
                                  <mat-icon class="edit" matSuffix
                                    >edit</mat-icon
                                  >
                                </mat-form-field>

                               
                                <mat-error
                                  class="error"
                                  *ngIf="
                                    telefono?.invalid &&
                                    (telefono?.dirty || telefono?.touched)
                                  "
                                >
                                <mat-error
                                    *ngIf="telefono?.errors?.['required']"
                                  >
                                  El teléfono es requerido.
                                  </mat-error>
                                  <mat-error
                                    *ngIf="telefono?.errors?.['pattern']"
                                  >
                                    El número de teléfono es inválido. Los
                                    formatos permitidos son: '1234567890',
                                    '123-4567890', '1234-567890' o
                                    '1234-56-7890'
                                  </mat-error>
                                </mat-error>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-3 mb-3">
                              <div
                                class="form-outline input-group mb-3 d-flex justify-content-center"
                              >
                                <mat-form-field appearance="fill">
                                  <mat-label>Fecha de Alta</mat-label>
                                  <input
                                    class="enabled"
                                    matInput
                                    type="text"
                                    id="fechaAlta"
                                    value="fechaAlta"
                                    formControlName="fechaAlta"
                                    readonly
                                  />
                                  <mat-icon class="enabled" matSuffix
                                    >calendar_month</mat-icon
                                  >
                                </mat-form-field>
                              </div>
                            </div>
                           
                            <div class="col-md-3 mb-3">
                              <div
                                class="form-outline input-group mb-3 d-flex justify-content-center"
                              >
                                <mat-form-field appearance="fill">
                                  <mat-label>Fecha de Baja </mat-label>
                                  <input
                                    class="enabled"
                                    matInput
                                    type="text"
                                    id="fechaBaja"
                                    value="fechaBaja"
                                    formControlName="fechaBaja"
                                    readonly
                                  />
                                  <mat-icon class="enabled" matSuffix
                                    >calendar_month</mat-icon
                                  >
                                </mat-form-field>
                              </div>
                            </div>
                          </div>
                          <div
                            class="col-6"
                            style="display: flex; justify-content: center"
                          >
                            <div class="example-button-row">
                              <button
                                mat-fab
                                extended
                                color="primary"
                                type="submit"
                                class="btn btnGuardar"
                                data-bs-toggle="button"
                                (click)="modificarCliente()"
                              >
                                Modificar Cliente
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-------------------- Blanqueamiento: .col-sm-4 ---------------------------------->
                    <div
                      class="col-sm-3"
                      style="display: flex; justify-content: left"
                    >
                      <div class="col-md-2 image-container">
                        <span
                          ><img
                            style="
                              width: 102%;
                              height: 102;
                              margin-bottom: 100px;
                            "
                            src="../../../assets/nube.png"
                            class="image"
                            alt="..."
                          />
                          <div class="example-button-row">
                            <button
                              mat-stroked-button
                              type="submit"
                              class="btnBlanqueoContraseña"
                              data-bs-toggle="button"
                              (click)="blanquearPassword()"
                            >
                              Blanquear Contraseña
                            </button>
                          </div>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </ng-container>
      </mat-step>
    </mat-vertical-stepper>
  </div>
  <br />
</div>
<!-- <app-footer-interno></app-footer-interno> -->
