<div class="body">
  <h1 class="text-center titulo tituloFuente">Registrar Configuración de Alarma </h1>
  <!-- Contenido de breadcrumb -->
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item" style="padding-left: 310px; font-size: 18px">
        <a href="/home">Home</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">
        Registrar Configuración de Alarma 
      </li>
    </ol>
  </nav>
  <div class="container mt-12">

<!-- ----------------------------Inicio de Paso a Paso-------------------------------------------- -->
<mat-vertical-stepper>
  <mat-step
    [label]="titulo1"
    [completed]="isStep1Completed"
    [ngClass]="{ collapse: isCollapsed1 }"
  >
    <ng-container contenido-paso-1>
      <div class="card-body" [ngClass]="{ collapse: isCollapsed2 }">
  
        <div class="row containerCard">
  
          <div class="col-12 cardFiltrado cardAnimate cardFlat cardSeparacion">
            <div>
              <div class="row">
                <div class="col-md-2 image-container">
                  <span
                    ><img
                      style="width: 102%; height: 102"
                      src="../../../assets/icons8-user-64_1.png"
                      class="image"
                      alt="..."
                    />
                    <div class="texto">
                      <h4
                        style="
                          text-align: center;
                          color: #63ddff;
                          font-size: 18px;
                        "
                      >
                        Filtrar Central
                      </h4>
                    </div></span
                  >
                </div>                 

                <div
                class="col-md-1 vertical-line"
                style="width: 20px"
              ></div>
              <div class="col-md-2 margenFiltros">
                <div
                  class="form-outline input-group"
                  data-toggle="tooltip"
                  data-placement="top"
                  title="Buscar por Código de Central"
                >
                  <label class="search-field">
                    <mat-label
                      class="search-field label ng-tns-c97-48 ng-star-inserted"
                      >Código de Central</mat-label
                    >
                    <input
                      type="text"
                      class="form-control inputBusqueda .input-con-color-de-fondo"
                      placeholder="Ej. 1"
                      (keyup)="esFiltrar($event , 'codigo')"
                    />                             
                    <i
                      class="fas fa-search FormatoIconos"
                      style="padding-left: 20px"
                    ></i>
                  </label>
                </div>                          
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 cardFiltrado cardAnimate cardFlat cardSeparacion">
          <div class="h-100 d-flex align-items-center justify-content-center">
            <div
              class="example-button-row"
              style="display: flex; justify-content: flex-end"
            >
              <button
                mat-fab
                extended
                color="primary"
                class="btnConsultarConfigAlarma"
                routerLink="/consultar-alarma-config"
              >
                <mat-icon>touch_app</mat-icon>
                Consultar Config. Alarmas
              </button>
            </div>
          </div>
        </div>   
     
      </div>
      <br />
      <br />


      <div class="row">
        <div class="col-12 cardFiltrado cardAnimate cardFlat">
          <table class="table" *ngIf="validarFiltrado() == true" id="servicio">
            <thead class="encabezado">
              <tr>
                <th
                  (click)="ordenarPor('cenNro')"
                  [appSort]="CentralConsultaFiltrados"
                  data-order="desc"
                  data-name="cenNro"
                  style="text-align: center"
                >
                  <a
                    >Cod. {{ ordenarIcono("cenNro") }}</a
                  >
                </th>
                <th
                  (click)="ordenarPor('cenImei')"
                  [appSort]="CentralConsultaFiltrados"
                  data-order="desc"
                  data-name="cenImei"
                  style="text-align: center"
                >
                  <a>IMEI {{ ordenarIcono("cenImei") }}</a>
                </th>
                <th
                  (click)="ordenarPor('cenCoorX')"
                  [appSort]="CentralConsultaFiltrados"
                  data-order="desc"
                  data-name="cenCoorX"
                  style="text-align: center"
                >
                  <a>Coordenada X {{ ordenarIcono("cenCoorX") }}</a>
                </th>
                <th
                  (click)="ordenarPor('cenCoorY')"
                  [appSort]="CentralConsultaFiltrados"
                  data-order="desc"
                  data-name="cenCoorY"
                  style="text-align: center"
                >
                  <a>Coordenada Y {{ ordenarIcono("cenCoorY") }}</a>
                </th>
                <th></th>
                <th scope="col">Seleccionar</th>             
              </tr>
            </thead>
            <tbody>
              <tr
                class="table-row"
                *ngFor="
                  let central of CentralConsultaFiltrados
                    | paginate
                    : {
                      itemsPerPage: pageSizeCentral,  
                      currentPage: currentPageCentral,  
                      totalItems: totalItemsCentral  
                    };
                  let i = index
                "
                [ngClass]="{
                  'fila-par': i % 2 == 0,
                  'fila-impar': i % 2 == 1
                }"
                (click)="esfilaSeleccionada(central)"
              >
                <th style="vertical-align: middle align-center">
                  {{ central.cenNro }}
                </th>
                <td style="vertical-align: middle" class="textDerecha">
                  {{ central.cenImei }}
                </td>
                <td style="vertical-align: middle" class="textDerecha">
                  {{ central.cenCoorX }}
                </td>
                <td style="vertical-align: middle" class="textDerecha">
                  {{ central.cenCoorY }}
                </td>  
                <td class="empty-column"></td>
                <td class="align-center">
                  <button
                    mat-button
                    (click)="esfilaSeleccionada(central) ; seleccionarCentral(); goToNextStep(1)"               
                    type="button"
                    class="btn"
                    data-bs-target="#staticBackdrop"
                    title="Seleccionar Cliente"
                  >
                    <img
                      src="../../../assets/seleccionarClie.png"
                      class="image"
                      alt="..."
                    />
                  </button>
                </td>

              </tr>
            </tbody>
          </table>
          <div
            class="align-center"
            *ngIf="validarFiltrado() == true"
          >
            <pagination-controls
              (pageChange)="paginaCambiadaCentral($event)"
              itemsPerPage="pageSizeCentral"
              totalItems="totalItemsCentral"
            ></pagination-controls>
          </div>
        </div>
        <div
          class="alert alert-primary text-center"
          role="alert"
          *ngIf="validarFiltrado() == false"
        >
          No se encontraron centrales que coincidan con su búsqueda.
        </div>
      </div>

        </div>
    </ng-container>
  </mat-step>

  <mat-step
  [label]="titulo2"
  [completed]="isStep2Completed"
  [ngClass]="{ collapse: isCollapsed2 }"
  >
    <ng-container contenido-paso-2>    
      <!-- Botón ver otra central -->
      <div class="row">
        <div
          class="example-button-row"
          style="display: flex; justify-content: flex-end"
        >
          <button
            mat-fab
            extended
            color="primary"
            class="btonNuevaConsulta"
            (click)="goToPreviousStep()"
          >
            <mat-icon>touch_app</mat-icon>
            Nueva Consulta
          </button>
        </div>
      </div>

      <div class="card cardFiltrado cardAnimate cardFlat">
        <div class="card-header">
          <div class="d-flex justify-content-between align-items-center">
            <h4 class="mb-0 tituloCard">Registrar Configuración de Alarma a la Central N°: {{centralNroSeleccionada}} </h4>
            <img
              src="../../../assets/seleccionar.png"
              class="image"
              style="width: 5%; height: 5%; padding-right: 5px"
              alt="..."
            />
          </div>
        </div>

        <br>  
        <br>  
        
        <form [formGroup]="formAgregar">
          <div class="container">
            <div class="row">
              <div class="col-sm-9" style="justify-content: right">
                <div class="row justify-content-center">
                  <div class="col-50 col-sm-50">
                    <div class="row">
                      <div class="col-md-6">
                        
                        <div class="form-outline input-group mb-3">
                          <mat-form-field
                            appearance="fill"
                            class="example-full-width form-outline input-group"
                          >
                            <mat-label>Nro Central</mat-label>
                            <input
                              type="text"
                              style="padding-left: 20px"
                              matInput
                              id="nroCentralA"
                              value="nroCentralA"
                              formControlName="nroCentralA"
                              required
                              readonly
                            />
                            <mat-icon class="edit" matSuffix
                              >edit_off</mat-icon
                            >
                          </mat-form-field>
                        </div>

                        <div class="form-outline input-group mb-3">
                          <mat-form-field
                            appearance="fill"
                            class="example-full-width form-outline input-group"
                          >
                            <mat-label>Nombre de Alarma</mat-label>
                            <input
                              type="text"
                              style="padding-left: 20px"
                              matInput
                              id="nombreAlarmaA"
                              value="nombreAlarmaA"
                              formControlName="nombreAlarmaA"
                              required
                            />
                            <mat-icon class="edit" matSuffix
                              >edit</mat-icon
                            >
                          </mat-form-field>
                          <mat-error
                            *ngIf="
                            nombreAlarmaA?.invalid &&
                              (nombreAlarmaA?.dirty ||
                              nombreAlarmaA?.touched)
                            "
                            class="text-danger"
                          >
                            <mat-error
                              class="error"
                              *ngIf="nombreAlarmaA?.errors?.['required']"
                            >
                              Debe ingresar un nombre de alarma.
                            </mat-error>
                            <mat-error
                              class="error"
                              *ngIf="nombreAlarmaA?.errors?.['pattern']"
                            >
                              No debe contener caracteres especiales ni tener más de 50 carácteres.                                                         
                            </mat-error>
                          </mat-error>
                        </div>

                        <div class="form-outline input-group mb-3">
                          <mat-form-field
                            style="width: 525px"
                            >
                            <mat-label>Seleccione un Servicio</mat-label>
                            <mat-select 
                              style="padding-left: 30px"                              
                              placeholder="Seleccionar un Servicio" 
                              required
                              id="nombreServicioA"
                              formControlName="nombreServicioA"
                              >
                              <mat-option *ngFor="let servicio of ServiciosCentralA" [value]="servicio.serId">
                                {{servicio.serDescripcion}}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                          <mat-error
                            *ngIf="
                            nombreServicioA?.invalid &&
                              (nombreServicioA?.dirty ||
                              nombreServicioA?.touched)
                            "
                            class="text-danger"
                          >
                            <mat-error
                              class="error"
                              *ngIf="nombreServicioA?.errors?.['required']"
                            >
                              Debe seleccionar un servicio.
                            </mat-error>
                          </mat-error>
                        </div>

                        <div class="form-outline input-group mb-3">
                          <mat-form-field
                            appearance="fill"
                            class="example-full-width form-outline input-group"
                          >
                            <mat-label>Límite Superior</mat-label>
                            <input
                              type="text"
                              style="padding-left: 20px"
                              matInput
                              id="cfgValorSuperiorAA"
                              value="cfgValorSuperiorAA"
                              formControlName="cfgValorSuperiorAA"
                              required
                            />
                            <mat-icon class="edit" matSuffix
                              >edit</mat-icon
                            >
                          </mat-form-field>
                          <mat-error
                            *ngIf="
                            cfgValorSuperiorAA?.invalid &&
                              (cfgValorSuperiorAA?.dirty ||
                              cfgValorSuperiorAA?.touched)
                            "
                            class="text-danger"
                          >
                            <mat-error
                              class="error"
                              *ngIf="cfgValorSuperiorAA?.errors?.['required']"
                            >
                              Debe ingresar un Límite Superior.
                            </mat-error>
                            <mat-error
                              class="error"
                              *ngIf="cfgValorSuperiorAA?.errors?.['pattern']"
                            >
                            Debe contener números con un máximo de dos decimales y no debe incluir caracteres especiales.
                            </mat-error>
                          </mat-error>
                        </div>

                        <div class="form-outline input-group mb-3">
                          <mat-form-field
                            appearance="fill"
                            class="example-full-width form-outline input-group"
                          >
                            <mat-label>Límite Inferior</mat-label>
                            <input
                              type="text"
                              style="padding-left: 20px"
                              matInput
                              id="cfgValorInferiorAA"
                              value="cfgValorInferiorAA"
                              formControlName="cfgValorInferiorAA"
                              required
                            />
                            <mat-icon class="edit" matSuffix
                              >edit</mat-icon
                            >
                          </mat-form-field>
                          <mat-error
                            *ngIf="
                            cfgValorInferiorAA?.invalid &&
                              (cfgValorInferiorAA?.dirty ||
                              cfgValorInferiorAA?.touched)
                            "
                            class="text-danger"
                          >
                            <mat-error
                              class="error"
                              *ngIf="cfgValorInferiorAA?.errors?.['required']"
                            >
                            Debe ingresar un Límite Inferior.
                          </mat-error>
                          <mat-error
                              class="error"
                              *ngIf="cfgValorInferiorAA?.errors?.['pattern']"
                            >
                            Debe contener números con un máximo de dos decimales y no debe incluir caracteres especiales.
                            </mat-error>
                          </mat-error>
                        </div>
                        
                        <div class="form-outline input-group mb-3">
                          <mat-form-field
                            appearance="fill"
                            class="example-full-width form-outline input-group"
                          >
                            <mat-label>Observación</mat-label>
                            <input
                              type="text"
                              style="padding-left: 20px"
                              matInput
                              id="cfgObservacionA"
                              value="cfgObservacionA"
                              formControlName="cfgObservacionA"                    
                            />
                            <mat-icon class="edit" matSuffix
                              >edit</mat-icon
                            >
                          </mat-form-field>
                          <mat-error
                            *ngIf="
                            cfgObservacionA?.invalid &&
                              (cfgObservacionA?.dirty ||
                              cfgObservacionA?.touched)
                            "
                            class="text-danger"
                          >
                          <mat-error
                              class="error"
                              *ngIf="cfgObservacionA?.errors?.['pattern']"
                            >
                            No debe contener caracteres especiales ni tener más de 100 carácteres.
                            </mat-error>
                          </mat-error>
                        </div>

                        <br>
                        <div
                          class="col-12 text-center"
                          style="display: flex; justify-content: center"
                        >
                          <div class="modal-footer example-button-row">
                            <button
                              mat-fab
                              extended
                              color="primary"
                              type="submit"
                              id="btnAgregar"
                              class="btn btnConfirmar"
                              data-bs-toggle="modal"
                              data-bs-target="#staticBackdrop"
                              (click)="agregarAlarmaConfig()"
                            >
                              Registrar Config. Alarma
                            </button>
                          </div>
                        </div> 

                      </div>
                    </div>
                

                  </div>
                </div>
              </div>

              <!-------------------- Ir a Consultar: .col-sm-4 ---------------------------------->
              <div
              class="col-sm-3"
              style="display: flex; justify-content: left"
            >
              <div class="col-md-2 image-container">
                <span
                  ><img
                    style="
                      width: 100%;
                      height: 100%;
                      margin-bottom: 100px;
                    "
                    src="../../../assets/nube.png"
                    class="image"
                    alt="..."
                  />
                <!-- Botón Consultar Config. Alarma -->
                <div class="row">
                  <div
                    class="example-button-row"
                    style="display: flex; justify-content: flex-end"
                  >
                    <button
                      mat-fab
                      extended
                      color="primary"
                      class="btnConsultarConfigAlarma"
                      routerLink="/consultar-alarma-config"
                      >
                      <mat-icon>touch_app</mat-icon>
                      Consultar Config. Alarmas
                    </button>
                  </div>
                </div>
                </span>
              </div>
            </div>


            </div>
          </div>
        </form>

      </div>
      </ng-container>
  </mat-step>
  
</mat-vertical-stepper>
</div>  
<br />
</div>
<br/>